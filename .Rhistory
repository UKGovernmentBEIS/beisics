devtools::load_all()
my_plot3 +
theme_beis(default_colours = FALSE) +
scale_y_log10() +
theme( axis.text.x = element_text(angle = 45, hjust = 1))
devtools::load_all()
my_plot3 +
theme_beis(default_colours = FALSE) +
scale_y_log10() +
theme( axis.text.x = element_text(angle = 45, hjust = 1))
my_plot3 +
theme_beis(default_colours = FALSE, distinct_colours = TRUE) +
scale_y_log10() +
theme( axis.text.x = element_text(angle = 45, hjust = 1))
table(diamonds$color)
my_plot5 <- ggplot(data = diamonds, aes(x = color, fill = color)) +
geom_bar()+
labs(title = "plot title", subtitle = "subtitle")
my_plot5 +
theme_beis()
my_plot2 +
theme_beis(default_colours = FALSE)
my_plot5 +
theme_beis(default_colours = FALSE)
my_plot5 +
theme_beis(distinct_colours = TRUE)
my_plot5 +
theme_beis() +
scale_fill_manual(values = c(beis_colours(), "Black"))
my_plot5 +
theme_beis() +
scale_fill_manual(values = c(beis_colours(distinct = TRUE), "Black"))
devtools::load_all()
my_plot5 +
theme_beis() +
scale_fill_manual(values = c(beis_colours(distinct = TRUE), "Black"))
devtools::build(path = getwd())
devtools::test()
devtools::load_all()
beis_colours(n = 16)
args(assert_that)
?assert_that
devtools::load_all()
beis_colours(n = 16)
beis_colours(n = 15, distinct = TRUE)
devtools::check()
devtools::build(path = getwd())
devtools::show_news()
usethis::use_news_md()
usethis::use_news_md()
knitr::knit('NEWS.md')
devtools::build(path = getwd(), binary = TRUE)
usethis::use_r("save_beis_xl")
require(openxlsx)
wb <- createWorkbook()
require(openxlsx)
wb <- createWorkbook()
saveWorkbook(wb = wb, file = "P:/we_test.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, "Table1")
saveWorkbook(wb = wb, file = "P:/we_test.xlsx", overwrite = TRUE)
1l
1L
5L
6LLLL
100L
trade <-
data.frame(
Country = c("France", "Germany", "Italy", "Spain", "UK"),
Imports = c(100000L, 150000L, 270000L, 123000L, 790000L),
Exports = c(230000L, 120000L, 870000L, 738000L, 654000L)
)
View(trade)
writeData(wb, "Trade", trade)
wb <- createWorkbook()
addWorksheet(wb, "Trade")
writeData(wb, "Trade", trade)
saveWorkbook(wb = wb, file = "P:/wb_test.xlsx", overwrite = TRUE)
?addStyle
save_beis_xl <- function(wb, file.path = "P:/wb_test.xlsx") {
saveWorkbook(wb = wb, file = file.path, overwrite = TRUE)
}
save_beis_xl(wb)
save_beis_xl <- function(wb, file.path = "P:/wb_test.xlsx") {
headerStyle <- createStyle(fontSize = 14, bgFill = beis_colours()[1], fontColour = "#FFFFFF")
saveWorkbook(wb = wb, file = file.path, overwrite = TRUE)
}
save_beis_xl <- function(wb, file.path = "P:/wb_test.xlsx") {
headerStyle <- createStyle(fontSize = 14, bgFill = beis_colours()[1], fontColour = "#FFFFFF")
addStyle(wb, style = headerStyle)
saveWorkbook(wb = wb, file = file.path, overwrite = TRUE)
}
save_beis_xl(wb)
save_beis_xl <- function(wb, file.path = "P:/wb_test.xlsx") {
headerStyle <- createStyle(fontSize = 14, bgFill = beisics::beis_colours()[1], fontColour = "#FFFFFF")
addStyle(wb, style = headerStyle)
saveWorkbook(wb = wb, file = file.path, overwrite = TRUE)
}
save_beis_xl(wb)
add_beis_style <- function(wb, sheet = 1) {
headerStyle <- createStyle(fontSize = 14, bgFill = beisics::beis_colours()[1], fontColour = "#FFFFFF")
addStyle(wb, style = sheet, headerStyle)
}
add_beis_style(wb)
add_beis_style <- function(wb, sheet = 1) {
headerStyle <- createStyle(fontSize = 14, bgFill = beisics::beis_colours()[1], fontColour = "#FFFFFF")
addStyle(wb, sheet = sheet, style = headerStyle)
}
add_beis_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
typeof(wb)
class(wb)
add_beis_header = style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:3) {
headerStyle <- createStyle(fontSize = 14, bgFill = beisics::beis_colours()[1], fontColour = "#FFFFFF")
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
add_beis_header = style(wb)
add_beis_header_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
beisics::beis_colours()[1]
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:3) {
headerStyle <- createStyle(fontSize = 14,
fgFill = beisics::beis_colours()[1],
fontColour = "#FFFFFF", )
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
add_beis_header_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:3) {
headerStyle <- createStyle(fontSize = 14,
fgFill = beisics::beis_colours()[1],
fontColour = "#FFFFFF", )
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
add_beis_header_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
?createStyle
add_beis_body_style <- function(wb, sheet = 1, rows = 1, cols = 1:3) {
bodyStyle <- createStyle(borderStyle = "none", numFmt = "#,###.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols)
}
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:3) {
headerStyle <- createStyle(fontSize = 14,
fgFill = beisics::beis_colours()[1],
fontColour = "#FFFFFF", textDecoration = "bold",
borderStyle = "none")
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
wb <- createWorkbook()
addWorksheet(wb, "Trade")
writeData(wb, "Trade", trade)
add_beis_header_style(wb)
add_beis_body_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:3) {
headerStyle <- createStyle(fontSize = 14,
fgFill = beisics::beis_colours()[1],
fontColour = "#FFFFFF", textDecoration = "bold",
borderStyle = "none")
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
wb <- createWorkbook()
addWorksheet(wb, "Trade")
writeData(wb, "Trade", trade)
add_beis_header_style(wb)
add_beis_body_style(wb)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:6, cols = 1:3) {
bodyStyle <- createStyle(borderStyle = "none", numFmt = "#,###.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols)
}
wb <- createWorkbook()
addWorksheet(wb, "Trade")
writeData(wb, "Trade", trade)
add_beis_header_style(wb)
add_beis_body_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:6, cols = 1:3) {
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols)
}
add_beis_body_style(wb)
wb <- createWorkbook()
addWorksheet(wb, "Trade")
writeData(wb, "Trade", trade)
add_beis_header_style(wb)
add_beis_body_style(wb)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:5, cols = 1:3) {
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols)
}
add_beis_body_style(wb)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:5, cols = 1:3) {
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0",
gridExpand = TRUE)
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols)
}
add_beis_body_style(wb)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:5, cols = 1:3) {
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
add_beis_body_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
showGridLines(wb, showGridLines = FALSE)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:5, cols = 1:3) {
showGridLines(wb, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
add_beis_body_style(wb)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:5, cols = 1:3) {
showGridLines(wb, sheet = sheet, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
add_beis_body_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:10, cols = 1:5) {
showGridLines(wb, sheet = sheet, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
add_beis_body_style(wb)
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:3) {
headerStyle <- createStyle(fontSize = 14,
fgFill = beisics::beis_colours()[1],
fontColour = "#FFFFFF", textDecoration = "bold",
borderStyle = "none")
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
add_beis_body_style <- function(wb, sheet = 1, rows = 2:10, cols = 1:5) {
showGridLines(wb, sheet = sheet, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:5) {
headerStyle <- createStyle(fontSize = 14,
fgFill = beisics::beis_colours()[1],
fontColour = "#FFFFFF", textDecoration = "bold",
borderStyle = "none")
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
add_beis_body_style <- function(wb, sheet = 1, rows = 2:10, cols = 1:5) {
showGridLines(wb, sheet = sheet, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
wb <- createWorkbook()
addWorksheet(wb, "Trade")
writeData(wb, "Trade", trade)
add_beis_header_style(wb)
add_beis_body_style(wb)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:10, cols = 1:5) {
showGridLines(wb, sheet = sheet, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
add_beis_body_style <- function(wb, sheet = 1, rows = 2:6, cols = 1:5) {
showGridLines(wb, sheet = sheet, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
add_beis_body_style(wb)
#create some dummy data
trade <-
data.frame(
Country = c("France", "Germany", "Italy", "Spain", "UK", "US"),
Imports = c(100000L, 150000L, 270000L, 123000L, 790000L, 5678900L),
Exports = c(230000L, 120000L, 870000L, 738000L, 654000L, 65678000L)
)
wb <- createWorkbook()
addWorksheet(wb, "Trade")
writeData(wb, "Trade", trade)
add_beis_header_style(wb)
add_beis_body_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:7, cols = 1:5) {
showGridLines(wb, sheet = sheet, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
trade <-
data.frame(
Country = c("France", "Germany", "Italy", "Spain", "UK", "US"),
Imports = c(100000L, 150000L, 270000L, 123000L, 790000L, 5678900L),
Exports = c(230000L, 120000L, 870000L, 738000L, 654000L, 65678000L)
)
wb <- createWorkbook()
addWorksheet(wb, "Trade")
writeData(wb, "Trade", trade)
add_beis_header_style(wb)
add_beis_body_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:3) {
headerStyle <- createStyle(fontSize = 14,
fgFill = beisics::beis_colours()[1],
fontColour = "#FFFFFF", textDecoration = "bold",
borderStyle = "none")
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
add_beis_body_style <- function(wb, sheet = 1, rows = 2:7, cols = 1:3) {
showGridLines(wb, sheet = sheet, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0")
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
trade <-
data.frame(
Country = c("France", "Germany", "Italy", "Spain", "UK", "US"),
Imports = c(100000L, 150000L, 270000L, 123000L, 790000L, 5678900L),
Exports = c(230000L, 120000L, 870000L, 738000L, 654000L, 65678000L)
)
wb <- createWorkbook()
addWorksheet(wb, "Trade")
writeData(wb, "Trade", trade)
add_beis_header_style(wb)
add_beis_body_style(wb)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:7, cols = 1:3, ...) {
showGridLines(wb, sheet = sheet, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0", ...)
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
add_beis_body_style(wb, textDecoration = "italic")
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_body_style <- function(wb, sheet = 1, rows = 2:7, cols = 1:3, ...) {
showGridLines(wb, sheet = sheet, showGridLines = FALSE)
bodyStyle <- createStyle(borderStyle = "none", numFmt = "0,000.0",
fontColour = beisics::beis_colours()[1], ...)
addStyle(wb, sheet = sheet, style = bodyStyle, rows = rows, cols =cols, gridExpand = TRUE)
}
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_body_style(wb, textDecoration = "italic")
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:3,
header_classic = TRUE) {
if(header_classic) {
headerStyle <- createStyle(fontSize = 12,
fontColour = beisics::beis_colours()[1],
textDecoration = "bold",
border = "bottom",
borderColour = beisics::beis_colours()[1],
halign = "right")
} else {
headerStyle <- createStyle(fontSize = 12,
fgFill = beisics::beis_colours()[1],
fontColour = "#FFFFFF", textDecoration = "bold",
borderStyle = "none")
}
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:3,
header_classic = TRUE, halign = right, ...) {
if(header_classic) {
headerStyle <- createStyle(fontSize = 12,
fontColour = beisics::beis_colours()[1],
textDecoration = "bold",
border = "bottom",
borderColour = beisics::beis_colours()[1],
halign = halign, ...)
} else {
headerStyle <- createStyle(fontSize = 12,
fgFill = beisics::beis_colours()[1],
fontColour = "#FFFFFF", textDecoration = "bold",
borderStyle = "none", ...)
}
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
add_beis_header_style(wb)
add_beis_header_style <- function(wb, sheet = 1, rows = 1, cols = 1:3,
header_classic = TRUE, halign = "right", ...) {
if(header_classic) {
headerStyle <- createStyle(fontSize = 12,
fontColour = beisics::beis_colours()[1],
textDecoration = "bold",
border = "bottom",
borderColour = beisics::beis_colours()[1],
halign = halign, ...)
} else {
headerStyle <- createStyle(fontSize = 12,
fgFill = beisics::beis_colours()[1],
fontColour = "#FFFFFF", textDecoration = "bold",
borderStyle = "none", ...)
}
addStyle(wb, sheet = sheet, style = headerStyle, rows = rows, cols =cols)
}
wb <- createWorkbook()
addWorksheet(wb, "Trade")
writeData(wb, "Trade", trade)
add_beis_header_style(wb)
add_beis_body_style(wb, textDecoration = "italic")
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_header_style(wb, header_classic = FALSE)
add_beis_body_style(wb, textDecoration = "italic")
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
usethis::use_package("openxlsx")
beisics::beis_colours()[1]
devtools::document()
devtools::document()
devtools::check(cran = FALSE)
devtools::check(cran = FALSE)
?asserthat::assertthat
?assertthat::assert_that
class(wb)
isClass(Workbook)
isClass(wb)
testthat::expect_is(wb, "Workbook")
if(class(wb) != "Workbook") stop ("wb must be of class type Workbook")
devtools::document()
devtools::load_all()
add_beis_body_style(mtcars)
class(wb)
class(wb) != "Workbook"
class(wb) == "Workbook"
add_beis_head_style(mtcars)
add_beis_header_style(mtcars)
?stopifnot
stopifnot(wb, isClass("Workbook"))
isClass(Workbook)
stopifnot("Workbook", isClass("wb))
)
getClass(wb)
stopifnot("Workbook", getClass("wb))
stopifnot("Workbook", getClass("wb"))
stopifnot("Workbook", isClass("wb"))
stopifnot("Workbook", isClass("wb"))
stopifnot("Workbook", getClass("wb"))
assert_that(class(wb) != "Workbook")
assert_that(class(wb) == "Workbook")
assert_that(class(wb) != "Workbook")
devtools::load_all()
add_beis_header_style(mtcars)
add_beis_header_style(wb = mtcars)
devtools::load_all()
add_beis_header_style(wb = mtcars)
devtools::load_all()
add_beis_header_style(wb = wb)
?assertthat::validate_that
validate_that(class(wb) != "Workbook")
assertthat::validate_that(class(wb) != "Workbook")
assertthat::validate_that(class(wb) == "Workbook")
assertthat::validate_that(class(mtcars) == "Workbook")
devtools::load_all()
add_beis_header_style(wb = mtcars)
devtools::load_all()
add_beis_header_style(wb = mtcars)
devtools::load_all()
add_beis_header_style(wb = mtcars)
assert_that(class(wb) == "Workbook")
devtools::check()
wb <- openxlsx::createWorkbook()
openxlsx::addWorksheet(wb, "Trade")
openxlsx::writeData(wb, "Trade", trade)
add_beis_header_style(wb, header_classic = FALSE)
add_beis_body_style(wb, textDecoration = "italic")
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
trade <-
data.frame(
Country = c("France", "Germany", "Italy", "Spain", "UK", "US"),
Imports = c(100000L, 150000L, 270000L, 123000L, 790000L, 5678900L),
Exports = c(230000L, 120000L, 870000L, 738000L, 654000L, 65678000L)
)
wb <- openxlsx::createWorkbook()
openxlsx::addWorksheet(wb, "Trade")
openxlsx::writeData(wb, "Trade", trade)
add_beis_header_style(wb, header_classic = FALSE)
add_beis_body_style(wb, textDecoration = "italic")
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
trade <-
data.frame(
Country = c("France", "Germany", "Italy", "Spain", "UK", "US"),
Imports = c(100000L, 150000L, 270000L, 123000L, 790000L, 5678900L),
Exports = c(230000L, 120000L, 870000L, 738000L, 654000L, 65678000L)
)
wb <- openxlsx::createWorkbook()
openxlsx::addWorksheet(wb, "Trade")
openxlsx::writeData(wb, "Trade", trade)
add_beis_header_style(wb, header_classic)
add_beis_body_style(wb, textDecoration = "italic")
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
add_beis_header_style(wb,)
add_beis_body_style(wb, textDecoration = "italic")
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
usethis::use_test("add_beis_body_style")
?expect_error
devtools::test()
?expect_error
devtools::test()
class(wb)
devtools::test()
devtools::test()
typeof(wb)
wb@.xData
wb[1]
class(wb@.xData)
typeof(wb@.xData)
wb
class(wb@.xData)
devtools::test()
devtools::check(cran = FALSE)
trade <-
data.frame(
Country = c("France", "Germany", "Italy", "Spain", "UK", "US"),
Imports = c(100000L, 150000L, 270000L, 123000L, 790000L, 5678900L),
Exports = c(230000L, 120000L, 870000L, 738000L, 654000L, 65678000L)
)
input <- openxlsx::createWorkbook()
openxlsx::addWorksheet(wb, "Trade")
openxlsx::writeData(wb, "Trade", trade)
devtools::check(cran = FALSE)
