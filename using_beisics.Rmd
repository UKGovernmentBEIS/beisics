---
title: "Using the beisics package"
author: "Advanced Analytics"
date: "13/05/2021"
output: 
  ioslides_presentation: 
    css: inst/css/beis_slides.css


---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## The beisics package

An R package created in 2020 for easy and consistent application of BEIS styling.

Available for all CBAS R users on the Windows desktop and the Rstudio and Rshiny servers.  Functions can be accessed through library(beisics) or beisics::<function>.

The package currently gives users access to:

- BEIS css sheet for styling and BEIS logo
- BEIS colours
- BEIS plot theme (ggplot2)
- BEIS Excel sheet styling formatting
- BEIS dygraph theme

## Feature 1

<br>
<br>
<br>
<br>
<center> <font size=12> get_beisics </font></centre>

## Feature 1: get_beisics

This feature copies both the BEIS like css and beis logo to an area of your choice.

```{r, eval = FALSE}
beisics::get_beisics(copy_to = "P:/Document")
```

Both of these can also be brought in separately via:

```{r, eval = FALSE}
beisics::get_beis_css()
beisics::get_beis_logo()
```



## Feature 1: get_beisics - Report styling

These can then be added to your R Markdown reports by calling in the YAML as follows

```{yaml, eval = FALSE}
title: "My awesome report"
author: "Joseph Bloggington"
date: "13/05/2021"
output: 
  html_document:
    css: beis_css.css

```

## Feature 2

<br>
<br>
<br>
<br>
<center> <font size=12> beis_colours </font></centre>

## Feature 2: BEIS colours

The BEIS colours, as hex codes, as of October 2020, can be accessed via calling the **beis_colours** function.

```{r}
beisics::beis_colours()
```

What these colours refer to can be accessed from the help function:

```{r, eval = FALSE}
?beis_colours()
```

## Feature 2: BEIS colours - plot
<font size=5> You can easily use the BEIS colours while plotting, below is an example with ggplot: </font>

```{r, warning=FALSE, message=FALSE, fig.height=3}
library(ggplot2); library(beisics)
ggplot(data = diamonds, aes(x = cut, fill = cut)) +
  geom_bar()+
  scale_fill_manual(values = beis_colours())
```

## Feature 2: BEIS colours - plot alternate
<font size=5> An alternative colour palette is available by setting the default argument to FALSE: </font>

```{r, warning=FALSE, message=FALSE, fig.height=3}
ggplot(data = diamonds, aes(x = cut, fill = cut)) +
  geom_bar()+
  scale_fill_manual(values = beis_colours(default = FALSE))
```

## Feature 3

<br>
<br>
<br>
<br>
<center> <font size=12> theme_beis </font></centre>

## Feature 3: Theme BEIS
<font size=5> Plots built using ggplot can also be styled using the theme_beis function. This is based on CAGG guidance from 2019.</font>

```{r, warning=FALSE, message=FALSE, fig.height=3}
ggplot(data = diamonds, aes(x = cut, fill = cut)) +
  geom_bar()+
  ggtitle("My diamonds plot")+
  theme_beis()
```

## Feature 3: Theme BEIS - alternative
<font size=5> Again, there are alternative options for colours within the theme</font>

```{r, warning=FALSE, message=FALSE, fig.height=3}
ggplot(data = diamonds, aes(x = cut, fill = cut)) +
  geom_bar()+
  ggtitle("My diamonds plot")+
  theme_beis(distinct_colours = TRUE)
```

## Feature 4

<br>
<br>
<br>
<br>
<center> <font size=12> Excel styling </font></centre>

## Feature 4: Excel styling

There are couple of Excel stylings also available which rely on the openxlss package. First we'll create some data

```{r}
 trade <-
  data.frame(
    Country = c("France", "Germany", "Italy", "Spain", "UK", "US", "China", "Saudi Arabia"),
    Imports = c(100000L, 150000L, 270000L, 123000L, 790000L, 5678900L, 6575859L, 47576L),
    Exports = c(230000L, 120000L, 870000L, 738000L, 654000L, 65678000L, 7876567L, 57575L)
  )

head(trade)

```

## Feature 4: Excel styling header 
<font size=5> We can add a styling to the header of an output with add_beis_header_style </font>
```{r}
wb <- openxlsx::createWorkbook()
openxlsx::addWorksheet(wb, "Trade")
openxlsx::writeData(wb, "Trade", trade)

add_beis_header_style(wb, header_classic = FALSE)

openxlsx::saveWorkbook(wb = wb, file =  "P:/wb_test.xlsx", overwrite = TRUE)
```
![](W:/TRAINSHARE/Coffee and Coding/beisics/excel_head_not_classic.PNG){height=200px}
